<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>생산</title>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.3/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://code.jquery.com/ui/1.13.3/jquery-ui.js"></script>

    <link href="/DataTables/datatables.css" rel="stylesheet">
    <script src="/DataTables/datatables.js"></script>

</head>
<body>
<p>생산</p>
<p>생산계획 <input type="text" id="datepicker"></p>
<div>
    <table id="myTable" class="display">
        <thead>
        <tr>
            <th>수주번호</th>
            <th>제품명</th>
            <th>업체명</th>
            <th>생산시작</th>
            <th>생산종료</th>
            <th>계획수량</th>
            <th>상태</th>
        </tr>
        </thead>
        <tbody>
        <tr>

        </tbody>
    </table>
</div>
<script>
    $(document).ready(function() {
        $.ajax({
            url: '/production/api/data',
            method: 'GET',
            success: function(data) {
                var table = $('#myTable').DataTable();
                data.forEach(function(item) {
                    table.row.add([
                        item.orderNumber,
                        item.productName,
                        item.client,
                        item.startDate ? new Date(item.startDate).toLocaleString() : '-',
                        item.endDate ? new Date(item.endDate).toLocaleString() : '-',
                        item.amount,
                        item.status
                    ]).draw(false);
                });
            }
        });
    });
</script>
<script>
    $(document).ready( function () {
        $('#myTable').DataTable();

        $("#datepicker").datepicker({
            onSelect: function() {
                var date = $.datepicker.formatDate('yymmdd', $("#datepicker").datepicker("getDate"));
                console.log(date);

                $.ajax({
                    url: '/production/plan',
                    type: 'POST',
                    contentType: 'application/json',
                    data: date,
                    success: function(response) {
                        console.log("Response from server: " + response);
                    },
                    error: function(error) {
                        console.error("Error: ", error);
                    }
                });
            },
            dateFormat: 'yy-mm-dd', // 달력 날짜 형태
            showOtherMonths: true, // 빈 공간에 현재월의 앞뒤월의 날짜를 표시
            showMonthAfterYear: true, // 월- 년 순서가 아닌 년도 - 월 순서
            changeYear: true, // option값 년 선택 가능
            changeMonth: true, // option값 월 선택 가능
            showOn: "both", // both: 버튼을 표시하고, 버튼을 누르거나 input을 클릭하면 달력 표시
            buttonImage: "http://jqueryui.com/resources/demos/datepicker/images/calendar.gif", // 버튼 이미지 경로
            buttonImageOnly: true, // 버튼 이미지만 깔끔하게 보이게 함
            buttonText: "선택", // 버튼 호버 텍스트
            yearSuffix: "년", // 달력의 년도 부분 뒤 텍스트
            monthNamesShort: ['1월','2월','3월','4월','5월','6월','7월','8월','9월','10월','11월','12월'], // 달력의 월 부분 텍스트
            monthNames: ['1월','2월','3월','4월','5월','6월','7월','8월','9월','10월','11월','12월'], // 달력의 월 부분 Tooltip
            dayNamesMin: ['일','월','화','수','목','금','토'], // 달력의 요일 텍스트
            dayNames: ['일요일','월요일','화요일','수요일','목요일','금요일','토요일'], // 달력의 요일 Tooltip
            minDate: "-5Y", // 최소 선택일자(-1D: 하루전, -1M: 한달전, -1Y: 일년전)
            maxDate: "+5Y" // 최대 선택일자(+1D: 하루후, +1M: 한달후, +1Y: 일년후)
        });

        $('#datepicker').datepicker('setDate', 'today');

    } );
</script>

</body>
</html>